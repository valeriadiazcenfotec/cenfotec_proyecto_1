<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="Emprendimientos.css">
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;600;700&display=swap" rel="stylesheet">
    <link href='https://cdn.boxicons.com/fonts/basic/boxicons.min.css' rel='stylesheet'>
    <link rel="stylesheet" href="css/menu.css">
    <link rel="stylesheet" href="css/Emprendimientos.css">
    <title>Emprendimientos</title>
</head>

<body>

    <!-- Menú de navegación -->
    <header class="header montserrat-semibold">
        <nav class="nav container">
            <div class="nav__data">
                <a href="#" class="nav__logo">
                    Comunidad Flores de Heredia
                </a>

                <div class="nav__toggle" id="nav-toggle">
                    <i class="fa-solid fa-bars nav__burger"></i>
                    <i class="fa-solid fa-xmark  nav__close"></i>
                </div>
            </div>

            <div class="nav__menu" id="nav-menu">
                <ul class="nav__list">
                    <li><a href="/Inicio" class="nav__link">Inicio</a></li>

                    <li class="dropdown__item">
                        <div class="nav__link">
                            Comunidad <i class="ri-arrow-down-s-line dropdown__arrow"></i>
                        </div>

                        <ul class="dropdown__menu">
                            <li>
                                <a href="/anuncios" class="dropdown__link">
                                    <i class="ri-pie-chart-line"></i> Anuncios comunitarios

                                </a>
                            </li>

                            <li>
                                <a href="/transporte" class="dropdown__link">
                                    <i class="ri-arrow-up-down-line"></i> Transporte público

                                </a>
                            </li>

                            <li>
                                <a href="/reportes" class="dropdown__link">
                                    <i class="ri-arrow-up-down-line"></i> Reportes quejas

                                </a>
                            </li>
                            <li>
                                <a href="/mapa" class="dropdown__link">
                                    <i class="ri-arrow-up-down-line"></i>Mapa

                                </a>
                            </li>
                        </ul>
                    </li>

                    <li><a href="/eventos" class="nav__link">Eventos</a></li>

                    <li class="dropdown__item">
                        <div class="nav__link">
                            Emprendimientos <i class="ri-arrow-down-s-line dropdown__arrow"></i>
                        </div>

                        <ul class="dropdown__menu">
                            <li>
                                <a href="/ofertas" class="dropdown__link">
                                    <i class="ri-user-line"></i> Ofertas y descuentos
                                </a>
                            </li>

                            <li>
                                <a href="/emprendimientos" class="dropdown__link">
                                    <i class="ri-lock-line"></i> Negocios
                                </a>
                            </li>
                    </li>

                </ul>
            </div>
        </nav>
    </header>



    <div class="filter">
        <div class="mini-nav">
            <input type="checkbox" id="check" />
            <label for="check" class="checkbtnicon">
                <i class='bx  bx-menu-filter'></i>
            </label>
            <label for="check" class="checkbtntext">
                <h3 class="filter_text">Filtrar</h3>
            </label>

            <div class="filtro-menu">
                <a href="/emprendimientos">Todos</a>
                <a href="/emprendimientos?categoria=alimentos">Alimentos</a>
                <a href="/emprendimientos?categoria=ropa">Ropa</a>
                <a href="/emprendimientos?categoria=tecnologia">Tecnología</a>
                <a href="/emprendimientos?categoria=servicios">Servicios</a>
            </div>



            <!--<div class="filter-options">
                <select id="category-filter">
                    <option value="all">Todas las categorías</option>
                    <option value="Comida">Comida </option>
                    <option value="Ropa">Ropa</option>
                    <option value="Servicios">Servicios</option>
                    <option value="Tecnología">Tecnología</option>
                </select>
            </div>-->

        </div>



        <div class="sales">
            <a class="link-to-offers" href="/ofertas">
                <button class="view-sales">
                    <h3 class="number">Ofertas
                    </h3>
                </button>
            </a>

        </div>
    </div>

    <!-- Contenido de emprendimientos -->
    <main>
        <section class="business_content">
            <div type="button" class="add_button"><a href="nuevo%20emprendimiento">+</a></div>
            <% emprendimientos.forEach(emp=> { %>
                <div class="business_card">
                    <div class="column">
                        <h2 class="business_title">
                            <%= emp.nombreN %>
                        </h2>
                        <p class="business_description">
                            <%= emp.descripcion %>
                        </p>
                    </div>

                    <div class="products">
                        <h3 class="products_title">Productos</h3>
                        <img src="/img/<%= emp.imagenNegocio %>" alt="Imagen negocio" class="product_img">
                        <button class="view-products">Ver productos</button>
                    </div>

                    <div class="carrusel">
                        <div class="imagenes">
                            <% emp.imagenesProductos.forEach(img=> { %>
                                <img src="/img/<%= img %>" class="imagen">
                                <% }) %>
                        </div>
                        <button class="anterior"><i class='bx bx-arrow-left-stroke'></i></button>
                        <button class="siguiente"><i class='bx bx-arrow-right'></i></button>
                    </div>

                    <button class="visualize" data-id="<%= emp._id %>">Visualizar</button>
                </div>
                <% }) %>
        </section>
    </main>

    <!-- Footer -->
    <footer class="footer-principal">
        <div class="footer-contenido">
            <div class="footer-info">
                <p><strong>Comunidad Unida</strong></p>
                <p>Flores, Heredia</p>
                <p>Tel: +506 8888-8888</p>
            </div>
            <div class="footer-creditos">
                <p>Diseñado por <strong>W4U</strong></p>
                <a href="../Landing/landing_page.html" target="_blank">
                    <img src="../img/logo-w4u.png" alt="Logo W4U" class="logo-creador" />
                </a>
            </div>
        </div>
    </footer>

    <!-- Scripts -->
    <script src="/menu/menu.js"></script>
    <script src="https://kit.fontawesome.com/2b7365d647.js" crossorigin="anonymous"></script>

    <script>
        // Obtener todos los carruseles en la página
        const carruseles = document.querySelectorAll('.carrusel');
        carruseles.forEach((carrusel) => {
            const imagenes = carrusel.querySelector('.imagenes');
            const total = carrusel.querySelectorAll('.imagenes img').length;
            const anterior = carrusel.querySelector('.anterior');
            const siguiente = carrusel.querySelector('.siguiente');
            let tamanoImagen = carrusel.querySelector('img').width;
            let indice = 0;
            // Función para actualizar el carrusel
            function actualizarCarrusel() {
                imagenes.style.transform = `translateX(-${indice * tamanoImagen}px)`;
            }
            // Botón siguiente
            siguiente.addEventListener('click', () => {
                indice = (indice + 1) % total;
                actualizarCarrusel();
            });
            // Botón anterior
            anterior.addEventListener('click', () => {
                indice = (indice - 1 + total) % total;
                actualizarCarrusel();
            });
            // Opcional: avance automático cada 5 segundos
            /*setInterval(() => {
                indice = (indice + 1) % total;
                actualizarCarrusel();
            }, 5000);*/
        });


        document.querySelectorAll('.visualize').forEach(button => {
            button.addEventListener('click', function () {
                const emprendimiento = this.closest('.business_card');

                // Obtiene el contenido de los elementos con clases genéricas
                const titulo = emprendimiento.querySelector('.business_title').textContent;
                const descripcion = emprendimiento.querySelector('.business_description').textContent;
                const imagenSrc = emprendimiento.querySelector('.imagen').src;
                const imagenAlt = emprendimiento.querySelector('.imagen').alt;

                // Redirige a la página genérica con los datos en la URL
                window.location.href = `VistaEmprendimientos.html?titulo=${titulo}&descripcion=${descripcion}&imagenSrc=${imagenSrc}&imagenAlt=${imagenAlt}`;
            });
        });

        document.getElementById("category-filter").addEventListener("change", function () {
            const selectedCategory = this.value; // Obtiene la categoría seleccionada
            const emprendimientos = document.querySelectorAll(".business_card"); // Obtiene todas las tarjetas de emprendimiento

            // Recorre todas las tarjetas de emprendimiento
            emprendimientos.forEach(emprendimiento => {
                const category = emprendimiento.dataset.category; // Obtiene la categoría del emprendimiento

                // Si la categoría seleccionada es "Todas las categorías", muestra todos los emprendimientos
                if (selectedCategory === "all" || selectedCategory === category) {
                    emprendimiento.style.display = "flex";
                } else {
                    emprendimiento.style.display = "none";
                }
            });
        });


    </script>
</body>


</html>